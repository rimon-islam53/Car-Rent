<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Manage Cars - AutoRent Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-50 min-h-screen flex flex-col">
    <!-- Navbar -->
    <nav class="bg-white shadow-md">
      <div
        class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center"
      >
        <a href="dashboard.html" class="text-2xl font-bold text-blue-600"
          >AutoRent Admin</a
        >
        <button id="logoutBtn" class="text-gray-700 hover:text-red-600">
          Logout
        </button>
      </div>
    </nav>

    <main class="max-w-7xl mx-auto px-6 py-10 flex-grow">
      <h1 class="text-3xl font-bold mb-8">Manage Cars</h1>

      <!-- Add New Car Button -->
      <button
        id="addCarBtn"
        class="mb-6 bg-green-600 text-white px-5 py-2 rounded hover:bg-green-700"
      >
        Add New Car
      </button>

      <!-- Cars Table -->
      <table
        class="w-full table-auto border-collapse border border-gray-300 bg-white rounded shadow"
      >
        <thead>
          <tr class="bg-gray-100">
            <th class="border border-gray-300 p-2 text-left">Name</th>
            <th class="border border-gray-300 p-2 text-left">Brand</th>
            <th class="border border-gray-300 p-2 text-left">Type</th>
            <th class="border border-gray-300 p-2 text-left">Price Per Day</th>
            <th class="border border-gray-300 p-2 text-center">Actions</th>
          </tr>
        </thead>
        <tbody id="carsTableBody">
          <!-- Rows added by JS -->
        </tbody>
      </table>

      <!-- Modal (hidden by default) -->
      <div
        id="modal"
        class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden"
      >
        <div class="bg-white rounded p-6 w-full max-w-md">
          <h2 id="modalTitle" class="text-xl font-bold mb-4">Add New Car</h2>
          <form id="carForm" class="space-y-4">
            <div>
              <label for="carName" class="block font-semibold mb-1">Name</label>
              <input
                type="text"
                id="carName"
                class="border p-2 rounded w-full"
                required
              />
            </div>

            <div>
              <label for="carBrand" class="block font-semibold mb-1"
                >Brand</label
              >
              <input
                type="text"
                id="carBrand"
                class="border p-2 rounded w-full"
                required
              />
            </div>

            <div>
              <label for="carType" class="block font-semibold mb-1">Type</label>
              <select id="carType" class="border p-2 rounded w-full" required>
                <option value="">Select type</option>
                <option value="Sedan">Sedan</option>
                <option value="SUV">SUV</option>
                <option value="Hatchback">Hatchback</option>
                <option value="Truck">Truck</option>
              </select>
            </div>

            <div>
              <label for="carPrice" class="block font-semibold mb-1"
                >Price Per Day</label
              >
              <input
                type="number"
                id="carPrice"
                class="border p-2 rounded w-full"
                min="0"
                required
              />
            </div>

            <div class="flex justify-end space-x-4 pt-4 border-t">
              <button
                type="button"
                id="cancelBtn"
                class="px-4 py-2 rounded border border-gray-300 hover:bg-gray-100"
              >
                Cancel
              </button>
              <button
                type="submit"
                class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
              >
                Save
              </button>
            </div>
          </form>
        </div>
      </div>
    </main>

    <script>
      // Sample car list
      let cars = [
        {
          id: 1,
          name: "Toyota Corolla",
          brand: "Toyota",
          type: "Sedan",
          price_per_day: 50,
        },
        {
          id: 2,
          name: "Honda Civic",
          brand: "Honda",
          type: "Sedan",
          price_per_day: 60,
        },
        {
          id: 3,
          name: "BMW X5",
          brand: "BMW",
          type: "SUV",
          price_per_day: 120,
        },
      ];

      const carsTableBody = document.getElementById("carsTableBody");
      const modal = document.getElementById("modal");
      const modalTitle = document.getElementById("modalTitle");
      const carForm = document.getElementById("carForm");
      const addCarBtn = document.getElementById("addCarBtn");
      const cancelBtn = document.getElementById("cancelBtn");

      let editingCarId = null;

      // Render cars in table
      function renderCars() {
        carsTableBody.innerHTML = "";
        cars.forEach((car) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
          <td class="border border-gray-300 p-2">${car.name}</td>
          <td class="border border-gray-300 p-2">${car.brand}</td>
          <td class="border border-gray-300 p-2">${car.type}</td>
          <td class="border border-gray-300 p-2">â‚±${car.price_per_day}</td>
          <td class="border border-gray-300 p-2 text-center space-x-2">
            <button class="editBtn text-blue-600 hover:underline" data-id="${car.id}">Edit</button>
            <button class="deleteBtn text-red-600 hover:underline" data-id="${car.id}">Delete</button>
          </td>
        `;
          carsTableBody.appendChild(tr);
        });

        // Attach edit/delete handlers
        document.querySelectorAll(".editBtn").forEach((btn) => {
          btn.addEventListener("click", () => {
            editingCarId = parseInt(btn.getAttribute("data-id"));
            openEditModal(editingCarId);
          });
        });

        document.querySelectorAll(".deleteBtn").forEach((btn) => {
          btn.addEventListener("click", () => {
            const id = parseInt(btn.getAttribute("data-id"));
            if (confirm("Are you sure you want to delete this car?")) {
              cars = cars.filter((c) => c.id !== id);
              renderCars();
            }
          });
        });
      }

      // Open modal for adding car
      addCarBtn.addEventListener("click", () => {
        editingCarId = null;
        modalTitle.textContent = "Add New Car";
        carForm.reset();
        modal.classList.remove("hidden");
      });

      // Open modal for editing car
      function openEditModal(id) {
        const car = cars.find((c) => c.id === id);
        if (!car) return;
        modalTitle.textContent = "Edit Car";
        document.getElementById("carName").value = car.name;
        document.getElementById("carBrand").value = car.brand;
        document.getElementById("carType").value = car.type;
        document.getElementById("carPrice").value = car.price_per_day;
        modal.classList.remove("hidden");
      }

      // Cancel button closes modal
      cancelBtn.addEventListener("click", () => {
        modal.classList.add("hidden");
      });

      // Form submit (add or edit)
      carForm.addEventListener("submit", (e) => {
        e.preventDefault();

        const name = document.getElementById("carName").value.trim();
        const brand = document.getElementById("carBrand").value.trim();
        const type = document.getElementById("carType").value;
        const price_per_day = parseFloat(
          document.getElementById("carPrice").value
        );

        if (!name || !brand || !type || isNaN(price_per_day)) {
          alert("Please fill all fields correctly.");
          return;
        }

        if (editingCarId) {
          // Edit existing car
          const index = cars.findIndex((c) => c.id === editingCarId);
          if (index !== -1) {
            cars[index] = {
              id: editingCarId,
              name,
              brand,
              type,
              price_per_day,
            };
          }
        } else {
          // Add new car
          const newId =
            cars.length > 0 ? Math.max(...cars.map((c) => c.id)) + 1 : 1;
          cars.push({ id: newId, name, brand, type, price_per_day });
        }

        modal.classList.add("hidden");
        renderCars();
      });

      // Initial render
      renderCars();

      // Logout button (optional)
      document.getElementById("logoutBtn").addEventListener("click", () => {
        alert("Logging out...");
        // Redirect or clear token logic here
      });
    </script>
  </body>
</html>
